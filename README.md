# é€šç”¨ SVG å˜å½¢å¼•æ“ (Universal SVG Morphing Engine)

è¿™æ˜¯ä¸€ä¸ªåŸºäº React çš„é«˜æ€§èƒ½ SVG è·¯å¾„å˜å½¢ï¼ˆMorphingï¼‰æ¼”ç¤ºé¡¹ç›®ã€‚æ—¨åœ¨æ¢ç´¢ä¸ä¾èµ– GSAP MorphSVG ç­‰ä»˜è´¹åº“çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•å®ç°ä»»æ„ SVG å½¢çŠ¶ã€ä»»æ„æ•°é‡å…ƒç´ ä¹‹é—´çš„å¹³æ»‘è¿‡æ¸¡åŠ¨ç”»ï¼Œå¹¶ä½¿ç”¨ anime.js 4.x è¿›è¡ŒåŠ¨ç”»è°ƒåº¦ã€‚

## ğŸš€ é¡¹ç›®æ¼”å˜ä¸æ ¸å¿ƒåŠŸèƒ½

æœ¬é¡¹ç›®ç»å†äº†ä» V1 åˆ° V6 çš„è¿­ä»£ï¼Œé€æ­¥è§£å†³äº†å½¢çŠ¶åŒ¹é…ã€å¤šå…ƒç´ æ˜ å°„ã€è‰²å½©è¿‡æ¸¡ä»¥åŠæµ·é‡å…ƒç´ æ¸²æŸ“çš„æ€§èƒ½ç“¶é¢ˆã€‚

### 1. æ ¸å¿ƒåŸç†ï¼šè·¯å¾„é‡é‡‡æ · (Path Resampling)

SVG çš„ d å±æ€§æŒ‡ä»¤å„ä¸ç›¸åŒï¼ˆå¦‚ C æ›²çº¿å¯¹ L ç›´çº¿ï¼‰ã€‚ä¸ºäº†å®ç°â€œä»»æ„â€å˜å½¢ï¼š
- ç®—æ³•ï¼šä½¿ç”¨ getPointAtLength() å°†ä»»æ„ SVG è·¯å¾„æ ‡å‡†åŒ–ä¸ºå›ºå®šæ•°é‡çš„åæ ‡ç‚¹ï¼ˆä¾‹å¦‚ 100 ä¸ªç‚¹ï¼‰ã€‚
- æ’å€¼ï¼šå°†å¤æ‚çš„è´å¡å°”æ›²çº¿è¿ç®—è½¬åŒ–ä¸ºç®€å•çš„é¡¶ç‚¹çº¿æ€§æ’å€¼ã€‚

### 2. æ™ºèƒ½å¯¹é½ (Smart Alignment)
- é—®é¢˜ï¼šç›´æ¥æ’å€¼ä¼šå¯¼è‡´å›¾å½¢åœ¨å˜å½¢æ—¶â€œè‡ªæˆ‘ç©¿æ’â€æˆ–â€œç¿»è½¬â€ï¼ˆæ‰“ç»“ç°è±¡ï¼‰ã€‚
- è§£å†³ï¼šå®ç°äº†ç±»ä¼¼äº GSAP shapeIndex çš„ç®—æ³•ã€‚é€šè¿‡æ—‹è½¬ç›®æ ‡ç‚¹é›†ï¼Œå¯»æ‰¾æ¬§å‡ é‡Œå¾—è·ç¦»æ€»å’Œæœ€å°çš„åç§»é‡ï¼ˆBest Offsetï¼‰ï¼Œç¡®ä¿å˜å½¢è¿‡ç¨‹è§†è§‰æœ€é¡ºæ»‘ã€‚

### 3. å¤šå¯¹å¤šæ˜ å°„ (N-to-M Morphing)
æ”¯æŒæºå½¢çŠ¶å’Œç›®æ ‡å½¢çŠ¶æ‹¥æœ‰ä¸åŒæ•°é‡çš„å­è·¯å¾„ï¼ˆä¾‹å¦‚ï¼š1ä¸ªåœ† â†” 150ä¸ªç²’å­ï¼‰ã€‚
- V6 ç­–ç•¥ (Collapse & Split)ï¼š
  - åç¼© (Collapse)ï¼šå½“ N > M æ—¶ï¼Œå¤šä¸ªæºå…ƒç´ é€šè¿‡å–æ¨¡æ˜ å°„ (i % M) é£å‘åŒä¸€ä¸ªç›®æ ‡å…ƒç´ ã€‚
  - åˆ†è£‚ (Split)ï¼šå½“ N < M æ—¶ï¼Œæºå…ƒç´ è¢«é€»è¾‘å¤åˆ¶ï¼Œåˆ†åˆ«é£å‘ä¸åŒçš„ç›®æ ‡å…ƒç´ ã€‚
  - å…¨å‘˜å‚æˆ˜ï¼šåºŸå¼ƒäº†â€œæ·¡å…¥æ·¡å‡ºâ€ç­–ç•¥ï¼Œç¡®ä¿æ‰€æœ‰å…ƒç´ éƒ½å‚ä¸å‡ ä½•å˜å½¢ï¼Œè§†è§‰æ•ˆæœæ›´éœ‡æ’¼ã€‚

### 4. è‰²å½©æ’å€¼
- æ”¯æŒ HEX é¢œè‰²çš„çº¿æ€§è¿‡æ¸¡ï¼Œä¸å½¢çŠ¶å˜å½¢åŒæ­¥ã€‚

##âš¡ï¸ æ€§èƒ½ä¼˜åŒ–æªæ–½ (Performance Optimizations)
å½“å±å¹•ä¸ŠåŒæ—¶æ¸²æŸ“ 200+ ä¸ª SVG è·¯å¾„å¹¶è¿›è¡Œ 60fps åŠ¨ç”»æ—¶ï¼Œæ€§èƒ½æ˜¯æœ€å¤§çš„æŒ‘æˆ˜ã€‚æˆ‘ä»¬é‡‡å–äº†ä»¥ä¸‹â€œæ ¸å¼¹çº§â€ä¼˜åŒ–ï¼š

### 1. ç»•è¿‡ React æ¸²æŸ“ (Direct DOM Manipulation)
- ç—›ç‚¹ï¼šReact çš„ setState -> Diff -> Render æµç¨‹åœ¨æ¯å¸§é«˜é¢‘è°ƒç”¨ä¸‹å¼€é”€è¿‡å¤§ã€‚
- æ–¹æ¡ˆï¼šä½¿ç”¨ useRef è·å– DOM èŠ‚ç‚¹ï¼Œåœ¨ anime.js çš„æ›´æ–°å›è°ƒä¸­ç›´æ¥è°ƒç”¨ element.setAttribute('d', ...)ã€‚
- æ”¶ç›Šï¼šæ€§èƒ½æå‡çº¦ 10 å€ï¼Œæ¶ˆé™¤äº† React è°ƒå’Œè¿‡ç¨‹çš„å¼€é”€ã€‚

### 2. åŠ¨æ€ç²¾åº¦è°ƒæ•´ (Dynamic LOD - Level of Detail)
æ ¹æ®å½“å‰æ¸²æŸ“çš„å…ƒç´ æ€»æ•°ï¼ŒåŠ¨æ€è°ƒæ•´æ¯ä¸ªè·¯å¾„çš„é‡‡æ ·ç‚¹æ•°ï¼š

| å…ƒç´ æ•°é‡ | é‡‡æ ·ç²¾åº¦ | è¯´æ˜ |
| :--- | :--- | :--- |
| < 50 | 120 ç‚¹ | æé«˜ç²¾åº¦ï¼Œé€‚åˆå±•ç¤ºç»†èŠ‚ |
| 50 - 100 | 60 ç‚¹ | å¹³è¡¡ç”»è´¨ä¸æµç•…åº¦ |
| > 100 | 30 ç‚¹ | ä½ç²¾åº¦ï¼Œä¾é æ•°é‡å¼¥è¡¥ç»†èŠ‚ï¼Œä¼˜å…ˆä¿è¯ FPS |

### 3. æ•´æ•°åæ ‡ä¼˜åŒ– (Integer Coordinates)
- ç—›ç‚¹ï¼šæµ®ç‚¹æ•°è·¯å¾„å­—ç¬¦ä¸²ï¼ˆå¦‚ M 10.123,20.456 L...ï¼‰è¿‡é•¿ï¼Œæµè§ˆå™¨è§£æå’Œå­—ç¬¦ä¸²æ‹¼æ¥è€—æ—¶ã€‚
- æ–¹æ¡ˆï¼šä½¿ç”¨ä½è¿ç®—å–æ•´ (x + 0.5) | 0ã€‚
- æ”¶ç›Šï¼šç”Ÿæˆçš„ d å±æ€§å­—ç¬¦ä¸²é•¿åº¦å‡å°‘ 50% ä»¥ä¸Šï¼Œè§£ææ›´å¿«ï¼Œä¸”è‚‰çœ¼å‡ ä¹æ— æ³•å¯Ÿè§‰ 0.5px çš„æŠ–åŠ¨ã€‚

### 4. æ™ºèƒ½å¸§ç‡é”å®š (Smart FPS Throttling)
- ç­–ç•¥ï¼šå½“æ£€æµ‹åˆ°â€œæµ·é‡å…ƒç´ â€ï¼ˆ>100 ä¸ªï¼‰æ¨¡å¼æ—¶ï¼Œè‡ªåŠ¨å°†æ›´æ–°é¢‘ç‡é™åˆ¶ä¸º 30fpsï¼ˆæ¯ä¸¤å¸§æ¸²æŸ“ä¸€æ¬¡ï¼‰ã€‚
- æ”¶ç›Šï¼šå¤§å¹…é™ä½ CPU å ç”¨ç‡ï¼Œé˜²æ­¢ä¸»çº¿ç¨‹é˜»å¡å¯¼è‡´æµè§ˆå™¨æ— å“åº”ã€‚

## ğŸ›  ä»£ç ç»“æ„
- src/data/menuItems.js: å…¥å£èœå•çš„ Tile é…ç½®ï¼ˆæ ‡é¢˜ã€æè¿°ã€ä¸»é¢˜è‰²ç­‰ï¼‰ã€‚
- src/pages/EntryMenu.jsx: æ–°å…¥å£èœå•é¡µé¢ï¼Œè´Ÿè´£æ¸²æŸ“åŠŸèƒ½å…¥å£ã€‚
- src/lib/svgMorphEngine.js: ç‹¬ç«‹çš„ SVG morph å¼•æ“æ¨¡å—ï¼ŒåŠ¨ç”»é©±åŠ¨æ”¹ç”± anime.js 4.x è´Ÿè´£è°ƒåº¦ã€‚
  - samplePath / createMorphInterpolator: è·¯å¾„é‡‡æ ·ä¸å¯¹é½ã€‚
  - createColorLerp / lerpColor: é¢œè‰²æ’å€¼ã€‚
  - buildStaticPathD / buildAnimatedPathD: è·¯å¾„å­—ç¬¦ä¸²æ„å»ºã€‚
  - createMorphEngine: åŠ¨ç”»é©±åŠ¨ä¸æ³¨å†Œç®¡ç†ã€‚
- src/features/universal-morph/UniversalMorph.jsx: å˜å½¢å¼•æ“ä¸»ç»„ä»¶ï¼Œè´Ÿè´£ UI äº¤äº’ä¸å¼•æ“æ¥å…¥ã€‚
  - generate*: å„ç§å¤æ‚ SVG è·¯å¾„ç”Ÿæˆå™¨ï¼ˆåŸå¸‚ã€èŠ±æœµã€çŸ©é˜µç­‰ï¼‰ã€‚
  - SHAPE_LIBRARY: é¢„è®¾çš„å›¾å½¢æ•°æ®ä»“åº“ã€‚
  - MorphingPath: å•ä¸ªè·¯å¾„ç»„ä»¶ï¼Œè´Ÿè´£åˆå§‹åŒ–æ•°æ®å’Œæ³¨å†Œ DOM å¼•ç”¨ã€‚
 
## ğŸ“¦ å¦‚ä½•ä½¿ç”¨
æœ¬é¡¹ç›®å·²æ•´ç†ä¸ºå¯ç›´æ¥è¿è¡Œçš„ Vite + React åº”ç”¨ï¼ˆUI ä¾èµ– Tailwind CDN ä¸ lucide-react å›¾æ ‡åº“ï¼‰ã€‚

### 1. å®‰è£…ä¾èµ–
```bash
yarn install
```

### 2. å¯åŠ¨å¼€å‘ç¯å¢ƒ
```bash
yarn dev
```

### 3. å…¥å£èœå•
åº”ç”¨å…¥å£ç°åœ¨æ˜¯ä¸€ä¸ªèœå•é¡µé¢ï¼Œé»˜è®¤å±•ç¤ºå¯ç”¨çš„æ¼”ç¤ºå…¥å£ã€‚ä½ å¯ä»¥åœ¨ `src/data/menuItems.js` ä¸­ç»§ç»­æ·»åŠ æ–°çš„ Tile é…ç½®ã€‚ 

### 4. ç»„ä»¶å…¥å£
å¦‚æœä½ æƒ³åœ¨åˆ«çš„é¡¹ç›®ä¸­å¤ç”¨ï¼Œå¯ä»¥ç›´æ¥å¼•å…¥ç»„ä»¶ï¼š
```js
import UniversalMorph from './features/universal-morph/UniversalMorph';

function App() {
  return (
    <div className="App">
      <UniversalMorph />
    </div>
  );
}
```

### 4. å¼•æ“æ¨¡å—å¤ç”¨
å¦‚æœä½ åªéœ€è¦æ ¸å¿ƒç®—æ³•ä¸åŠ¨ç”»é©±åŠ¨ï¼Œå¯ä»¥å•ç‹¬å¼•å…¥å¼•æ“æ¨¡å—ï¼š
```js
import {
  createMorphEngine,
  createMorphInterpolator,
  createColorLerp,
  buildStaticPathD
} from './lib/svgMorphEngine';

const engine = createMorphEngine({ duration: 2000 }); // duration å•ä½ï¼šæ¯«ç§’
const interpolator = createMorphInterpolator(startD, endD, {
  samples: 120,
  optimize: true
});
const color = createColorLerp('#3B82F6', '#F59E0B');

// æ³¨å†Œ DOM èŠ‚ç‚¹åå³å¯è°ƒç”¨ engine.play / engine.renderStatic
// å¼•æ“å†…éƒ¨ä½¿ç”¨ anime.js 4.x æ§åˆ¶åŠ¨ç”»æ—¶åº
```

## ğŸ”® æœªæ¥å±•æœ›
- Web Worker: å°†ç¹é‡çš„ç‚¹æ’å€¼è®¡ç®—æ”¾å…¥ Worker çº¿ç¨‹ã€‚
- WebGL/Canvas: å¯¹äºè¶…è¿‡ 1000 ä¸ªç²’å­çš„å˜å½¢ï¼ŒSVG æ€§èƒ½ä¼šè¾¾åˆ°ç“¶é¢ˆï¼Œæœªæ¥å¯è¿ç§»è‡³ Canvas æ¸²æŸ“ã€‚
